(function ($, Drupal) {
    'use strict';
$('.grid .item').on('click', function() {
    if($(this).hasClass( "active")){
        let item_this = $(this);
        let display = item_this.closest('.grid').find('.grid--display');
        display.removeClass('active');
        display.css({
            top: '100%' ,
            height: '0'
        }).html('');
        let loop = $(this);
        let offset = $(this).position().top;
        do {
            loop.css({'margin-bottom': '30px'});
            loop = loop.next('.item');
        } while (loop.length && loop.offset().top == offset);  
        $(this).removeClass('active');
    }
    else{
        let item_this = $(this);        
        $(this).closest('.grid--thumbnails').find('.item').removeAttr('style');
        let target = $($(this).data('target'));    
        if(target.length ){            
            let offset = $(this).position().top;
            let loop = $(this);
            loop.css({'margin-bottom': target.outerHeight()});        
            let display = item_this.closest('.grid').find('.grid--display');
            $([document.documentElement, document.body]).animate({
                scrollTop: $(this).offset().top
            }, 700);
            display.addClass('active');
            
            display.css({
                top: item_this.position().top + item_this.outerHeight() ,
                height: target.outerHeight()
            }).html('<button type="button" class="close" aria-label="Close"><span aria-hidden="true"><i class="ri-close-line"></i></span></button>'+target.html());       
            
            $('.grid .item').each(function() {      
                $( this ).removeClass( "active" );
            });
            $(this).addClass('active');
            $('.grid--display .close').on('click', function() {
                $('.grid--display').removeClass('active');
                $('.grid--display').css({
                    top: '100%' ,
                    height: '0'
                }).html('');  
                $('.grid .item').css({'margin-bottom': '30px'});
                $('.grid .item').removeClass('active');
            });
        }    
        else{
            let offset = $(this).position().top;
            let loop = $(this);
            loop.css({'margin-bottom': target.outerHeight()});        
            let display = item_this.closest('.grid').find('.grid--display');
            $([document.documentElement, document.body]).animate({
                scrollTop: $(this).offset().top
            }, 700);
            //display.addClass('active');            
            display.css({                
                top: '100%' ,
                height: '0'                
            }).html('');       
            
            $('.grid .item').each(function() {      
                $( this ).removeClass( "active" );
            });
            //$(this).addClass('active');
            $('.grid--display .close').on('click', function() {
                $('.grid--display').removeClass('active');
                $('.grid--display').css({
                    top: '100%' ,
                    height: '0'
                }).html('');  
                $('.grid .item').css({'margin-bottom': '30px'});
                $('.grid .item').removeClass('active');
            });
        }   
             
       
    } 
});
})(jQuery, Drupal);